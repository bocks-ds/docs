class ABCDoc {

    constructor(source_directory, target_file) {
        if (this.constructor === ABCDoc) {
            throw new TypeError('Abstract class "ABCDoc" cannot be instantiated directly.'); 
        }
        this.target_file = target_file
        this.source_dir = source_directory
        this.doc = this.get_doc()
        this.write().then(_ => {
            this.check_written()
        }).catch(err => {env.logger.debug(err)})
    }

    async write() {
        fs.writeFile(this.target_file, this.doc, function (err) {
            if (err) return console.log(err);
            console.log('Relationships written to file.');
        });
    }

    check_written() {
        fs.readFile(this.target_file, (err, data) => {
            this.data = data
            if (err) throw err;
        });
        if (this.data != this.doc) {
            let err = `File readable, but data does not match:\n${this.data}\n----------\n${this.doc}`
            throw Error(err)
        }
    }

}

module.exports = ABCDoc